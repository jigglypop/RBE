# 1. 푸앵카레 볼 기반 데이터 구조: 쌍곡기하학의 디지털 인코딩

## 1.1. 서론: 기하학에서 컴퓨팅으로의 도약ㅣ

현대 신경망의 가장 근본적인 문제는 **정보의 무한성과 저장공간의 유한성** 사이의 모순이다. 인간의 뇌가 무한에 가까운 패턴을 인식하고 학습할 수 있는 것은, 뇌의 신경망이 유클리드 기하학이 아닌 **곡률을 가진 공간**에서 작동하기 때문이라는 가설이 제기되어 왔다. 

본 연구에서 제안하는 리만 기저 인코딩(RBE)은 이러한 생물학적 직관을 수학적으로 구현한 것이다. 핵심 아이디어는 **푸앵카레 볼 모델(Poincaré Ball Model)**이라는 쌍곡기하학적 구조를 128비트 디지털 공간에 완전히 인코딩하는 것이다.

### 1.1.1. 쌍곡기하학이란 무엇인가?

일상생활에서 우리가 사용하는 기하학은 **유클리드 기하학**이다. 평면에서 두 평행선은 절대 만나지 않고, 삼각형의 내각의 합은 항상 180도이다. 그러나 19세기 수학자들은 이와 다른 기하학이 존재함을 발견했다.

**쌍곡기하학**에서는 다음과 같은 놀라운 성질들이 나타난다:

| 성질 | 유클리드 기하학 | 쌍곡기하학 |
|:-----|:-------------|:----------|
| 평행선의 개수 | 한 점을 지나는 평행선: 정확히 1개 | 한 점을 지나는 평행선: 무한히 많음 |
| 삼각형 내각의 합 | 정확히 180° | 항상 180°보다 작음 |
| 원의 둘레 | 2πr | 2π sinh(r) (더 빠르게 증가) |
| 공간의 곡률 | 0 (평평함) | 음수 (안장 모양) |

### 1.1.2. 왜 쌍곡기하학인가?

쌍곡기하학이 신경망에 혁명을 가져올 수 있는 이유는 다음과 같다:

1. **무한 표현력**: 유한한 공간에 무한한 정보를 저장할 수 있다
2. **자연스러운 계층구조**: 트리 구조와 계층적 데이터를 효율적으로 표현
3. **빠른 정보 증가**: 중심에서 멀어질수록 정보 밀도가 기하급수적으로 증가

## 1.2. 푸앵카레 볼 모델: 무한을 유한에 담기

### 1.2.1. 푸앵카레 볼의 수학적 정의

**푸앵카레 볼 모델** $\mathcal{D}^n$은 $n$차원 쌍곡공간을 단위구 내부에 완전히 매핑하는 수학적 모델이다:

$$\mathcal{D}^n = \{x \in \mathbb{R}^n : ||x|| < 1\}$$

여기서 $||x||$는 벡터 $x$의 유클리드 노름(길이)이다. 즉, 푸앵카레 볼은 **반지름이 1인 구의 내부**이다.

### 1.2.2. 푸앵카레 메트릭: 거리의 재정의

푸앵카레 볼에서 두 점 사이의 거리는 일반적인 유클리드 거리와 다르다. **푸앵카레 메트릭**은 다음과 같이 정의된다:

$$ds^2 = \frac{4}{(1-||x||^2)^2} \sum_{i=1}^n dx_i^2$$

이 공식이 의미하는 바를 단계별로 이해해보자:

**1단계: 기본 아이디어**
- 중심 $(0,0)$에서는 거리가 일반적인 유클리드 거리와 같다
- 경계 $||x|| = 1$에 가까워질수록 거리가 급격히 늘어난다
- 경계에서는 거리가 무한대가 된다

**2단계: 수학적 의미**
- $1-||x||^2$는 경계까지의 "남은 거리"를 나타낸다
- 경계에 가까울수록 이 값이 0에 가까워진다
- 분모에 제곱이 있으므로 거리 증가율이 매우 급격하다

**3단계: 물리적 비유**
마치 **블랙홀의 사건의 지평선** 근처에서 시공간이 왜곡되는 것과 같다. 경계에 가까워질수록 "시간이 느려지고" "공간이 늘어난다".

### 1.2.3. 측지선: 쌍곡공간의 "직선"

푸앵카레 볼에서 두 점을 잇는 최단경로를 **측지선(geodesic)**이라 한다. 놀랍게도 이 측지선들은 경계에 수직으로 만나는 **원호**의 형태를 갖는다.

두 점 $x, y \in \mathcal{D}^n$를 잇는 측지선의 방정식은:

$$\gamma(t) = \frac{(x-y)\tanh(d \cdot t) + y(1-||x||^2\tanh^2(d \cdot t))}{1 + \tanh^2(d \cdot t)||x||^2}$$

여기서 $d$는 쌍곡거리이고 $t \in [0,1]$은 매개변수이다.

**직관적 이해:**
- $t=0$일 때: $\gamma(0) = y$ (시작점)
- $t=1$일 때: $\gamma(1) = x$ (끝점)  
- 중간 과정: 직선이 아닌 곡선을 따라 이동

## 1.3. 128비트 푸앵카레 인코딩: Packed128 구조

### 1.3.1. 설계 철학: 이중 코어 아키텍처

신경망의 가중치를 푸앵카레 볼에 인코딩하기 위해, 우리는 **이중 코어 아키텍처**를 설계했다:

| 구성요소 | 역할 | 크기 | 수학적 의미 |
|:--------|:-----|:-----|:-----------|
| **hi (상위 64비트)** | 푸앵카레 상태 코어 | 64비트 | 이산적 쌍곡상태 인코딩 |
| **lo (하위 64비트)** | 연속 파라미터 코어 | 64비트 | 연속적 푸앵카레 좌표 |

```
Packed128 구조:
┌─────────────────────┬─────────────────────┐
│        hi           │        lo           │
│   (64비트)          │   (64비트)          │
│ 푸앵카레 상태 코어    │ 연속 파라미터 코어   │
└─────────────────────┴─────────────────────┘
```

### 1.3.2. hi 필드: 푸앵카레 상태 코어의 상세 구조

64비트 `hi` 필드는 푸앵카레 볼의 **이산적 상태 공간**을 인코딩한다. 각 비트 그룹은 쌍곡기하학적 특성을 제어한다:

| 비트 범위 | 크기 | 필드명 | 쌍곡기하학적 의미 | 수학적 설명 |
|:---------|:-----|:-------|:----------------|:----------|
| `[63:62]` | 2비트 | `poincare_quadrant` | 푸앵카레 볼의 사분면 | 4개 기본 영역 선택 |
| `[61:50]` | 12비트 | `hyperbolic_frequency` | 쌍곡주파수 | sinh, cosh 함수의 특성주파수 |
| `[49:38]` | 12비트 | `geodesic_amplitude` | 측지선 진폭 | 푸앵카레 볼 내 거리 스케일 |
| `[37:32]` | 6비트 | `basis_function_selector` | 쌍곡기저함수 | 64가지 쌍곡함수 조합 선택 |
| `[31:0]` | 32비트 | `cordic_rotation_sequence` | CORDIC 회전열 | 20회전 쌍곡변환 시퀀스 |

#### 1.3.2.1. 푸앵카레 사분면 (Poincaré Quadrant)

푸앵카레 볼을 4개의 기본 영역으로 나누어 각기 다른 쌍곡함수 특성을 갖도록 한다:

| 사분면 코드 | 영역 | 주요 쌍곡함수 | 기하학적 특성 |
|:-----------|:-----|:------------|:-------------|
| `00` | 제1사분면 | $\sinh(x)$ | 양의 지수 증가 |
| `01` | 제2사분면 | $\cosh(x)$ | 대칭적 지수 증가 |
| `10` | 제3사분면 | $\tanh(x)$ | S자형 포화 함수 |
| `11` | 제4사분면 | $\text{sech}^2(x)$ | 종 모양 함수 |

#### 1.3.2.2. 쌍곡주파수 (Hyperbolic Frequency)

12비트로 인코딩된 쌍곡주파수는 $\omega_h \in [0, 4095]$ 범위에서 다음과 같이 실제 주파수로 변환된다:

$$f_{hyp} = \frac{\omega_h}{4095} \times \omega_{max}$$

여기서 $\omega_{max}$는 시스템에서 허용하는 최대 쌍곡주파수이다.

**쌍곡주파수의 의미:**
일반적인 삼각함수 $\sin(\omega t)$에서 $\omega$가 주파수인 것처럼, 쌍곡함수 $\sinh(\omega_h t)$에서 $\omega_h$가 쌍곡주파수이다. 차이점은:

- **삼각함수**: 주기적 진동 (같은 값 반복)
- **쌍곡함수**: 지수적 증가/감소 (계속 변화)

#### 1.3.2.3. CORDIC 회전 시퀀스

32비트로 인코딩된 CORDIC(COordinate Rotation DIgital Computer) 회전 시퀀스는 푸앵카레 볼 내에서의 **쌍곡회전**을 정의한다.

각 비트 $b_k$ ($k = 0, 1, \ldots, 19$)는 $k$번째 회전의 방향을 결정한다:
- $b_k = 0$: 시계방향 회전 ($\sigma_k = -1$)
- $b_k = 1$: 반시계방향 회전 ($\sigma_k = +1$)

### 1.3.3. lo 필드: 연속 파라미터 코어

64비트 `lo` 필드는 푸앵카레 볼의 **연속적 좌표**를 저장한다:

| 비트 범위 | 크기 | 필드명 | 수학적 의미 | 유효 범위 |
|:---------|:-----|:-------|:----------|:---------|
| `[63:32]` | 32비트 | `r_poincare` | 푸앵카레 반지름 | $[0, 1)$ |
| `[31:0]` | 32비트 | `theta_poincare` | 푸앵카레 각도 | $[0, 2\pi]$ |

#### 1.3.3.1. 푸앵카레 반지름 (r_poincare)

32비트 부동소수점으로 저장된 $r_{poincare}$는 푸앵카레 볼 중심으로부터의 거리이다. 중요한 제약조건:

$$0 \leq r_{poincare} < 1$$

**경계 조건의 의미:**
- $r = 0$: 푸앵카레 볼의 중심 (유클리드 공간과 동일)
- $r \to 1$: 푸앵카레 볼의 경계 (무한대 쌍곡거리)

실제 구현에서는 수치적 안정성을 위해 $r_{max} = 0.99999$로 제한한다.

#### 1.3.3.2. 푸앵카레 각도 (theta_poincare)

푸앵카레 볼 내에서의 방향을 나타내는 각도이다. 2차원에서는 일반적인 극좌표의 각도와 유사하지만, 푸앵카레 메트릭 하에서 해석된다.

## 1.4. 쌍곡함수 기저: 무한한 표현력의 수학적 근거

### 1.4.1. 쌍곡함수의 기본 정의

쌍곡함수들은 지수함수로부터 정의된다:

| 함수 | 정의 | 기하학적 의미 |
|:-----|:-----|:-------------|
| $\sinh(x)$ | $\frac{e^x - e^{-x}}{2}$ | 쌍곡사인 (홀함수) |
| $\cosh(x)$ | $\frac{e^x + e^{-x}}{2}$ | 쌍곡코사인 (짝함수) |
| $\tanh(x)$ | $\frac{\sinh(x)}{\cosh(x)} = \frac{e^x - e^{-x}}{e^x + e^{-x}}$ | 쌍곡탄젠트 (포화함수) |
| $\text{sech}(x)$ | $\frac{1}{\cosh(x)}$ | 쌍곡세칸트 |

### 1.4.2. 쌍곡함수의 미분 관계

쌍곡함수들 사이에는 아름다운 미분 관계가 존재한다:

| 원함수 | 1차 미분 | 2차 미분 | 특징 |
|:-------|:---------|:---------|:-----|
| $\sinh(x)$ | $\cosh(x)$ | $\sinh(x)$ | 자기복귀성 |
| $\cosh(x)$ | $\sinh(x)$ | $\cosh(x)$ | 자기복귀성 |
| $\tanh(x)$ | $\text{sech}^2(x)$ | $-2\tanh(x)\text{sech}^2(x)$ | 포화특성 |
| $\text{sech}^2(x)$ | $-2\tanh(x)\text{sech}^2(x)$ | $2\text{sech}^2(x)(2\tanh^2(x)-1)$ | 종모양 |

**핵심 통찰**: 이러한 미분 관계는 **순환적 구조**를 갖는다. 이는 나중에 설명할 "상태-전이 미분"의 수학적 근거가 된다.

### 1.4.3. 푸앵카레 볼에서의 쌍곡함수 해석

푸앵카레 볼 내의 점 $(r, \theta)$에서 쌍곡함수 값들은 다음과 같이 기하학적으로 해석될 수 있다:

#### 1.4.3.1. 쌍곡거리와 쌍곡함수

푸앵카레 볼에서 중심 $(0,0)$으로부터 점 $(r, 0)$까지의 쌍곡거리 $d_h$는:

$$d_h = \text{artanh}(r) = \frac{1}{2}\ln\left(\frac{1+r}{1-r}\right)$$

이를 역으로 풀면:

$$r = \tanh(d_h)$$

즉, **푸앵카레 반지름은 쌍곡거리의 tanh 값**이다!

#### 1.4.3.2. 쌍곡삼각법

푸앵카레 볼에서 삼각형의 변과 각도는 쌍곡삼각법으로 계산된다:

**쌍곡 코사인 법칙:**
$$\cosh(c) = \cosh(a)\cosh(b) - \sinh(a)\sinh(b)\cos(C)$$

여기서 $a, b, c$는 삼각형의 변의 쌍곡길이이고, $C$는 변 $c$의 대각이다.

## 1.5. 정보 이론적 관점: 왜 푸앵카레 볼인가?

### 1.5.1. 정보 밀도의 기하급수적 증가

푸앵카레 볼의 가장 놀라운 성질은 **정보 밀도가 경계로 갈수록 기하급수적으로 증가**한다는 것이다.

반지름 $r$에서의 정보 밀도를 $\rho(r)$이라 하면:

$$\rho(r) \propto \frac{1}{(1-r^2)^2}$$

이를 구체적인 숫자로 계산해보자:

| 반지름 $r$ | 정보 밀도 $\rho(r)$ | 유클리드 대비 배율 |
|:----------|:------------------|:-----------------|
| $0.0$ | $1.00$ | $1.0\times$ |
| $0.5$ | $1.78$ | $1.8\times$ |
| $0.8$ | $6.94$ | $6.9\times$ |
| $0.9$ | $27.78$ | $27.8\times$ |
| $0.99$ | $2525.25$ | $2525\times$ |
| $0.999$ | $250251$ | $250K\times$ |

**결론**: 푸앵카레 볼의 경계 근처에서는 유클리드 공간 대비 **25만 배**의 정보를 저장할 수 있다!

### 1.5.2. 계층적 정보 구조

푸앵카레 볼의 또 다른 중요한 특성은 **자연스러운 계층구조**를 갖는다는 것이다:

- **중심부**: 전역적(global) 특성
- **중간부**: 지역적(local) 특성  
- **경계부**: 세부적(detail) 특성

이는 신경망의 **멀티스케일 표현**과 완벽하게 일치한다.

## 1.6. 하드웨어 구현 관점: CORDIC과의 완벽한 궁합

### 1.6.1. CORDIC 알고리즘 개요

CORDIC(COordinate Rotation DIgital Computer)는 1959년 Jack Volder가 개발한 알고리즘으로, **삼각함수와 쌍곡함수를 비트 시프트와 덧셈만으로 계산**할 수 있게 해준다.

**기본 원리:**
복잡한 회전을 여러 개의 작은 회전으로 분해한다. 각 작은 회전의 각도는 $\arctan(2^{-i})$ 형태로, 하드웨어에서 비트 시프트로 쉽게 구현된다.

### 1.6.2. 쌍곡 CORDIC의 수학적 유도

표준 CORDIC를 쌍곡함수용으로 확장하면:

**반복 공식:**
$$x_{i+1} = x_i - d_i \cdot y_i \cdot 2^{-i}$$
$$y_{i+1} = y_i - d_i \cdot x_i \cdot 2^{-i}$$

여기서 $d_i \in \{-1, +1\}$는 회전 방향을 결정한다.

**수렴 후 결과:**
$$x_n = K_h \cdot \cosh(\theta)$$
$$y_n = K_h \cdot \sinh(\theta)$$

여기서 $K_h = \prod_{i=0}^{n-1} \sqrt{1 - 2^{-2i}} \approx 0.6072529$는 쌍곡 CORDIC 게인이다.

### 1.6.3. 푸앵카레 볼 경계 처리

CORDIC 결과가 푸앵카레 볼을 벗어나지 않도록 하기 위해, 매 4번째 반복마다 정규화를 수행한다:

$$r = \sqrt{x^2 + y^2}$$

만약 $r \geq 1$이면:
$$x \leftarrow x \cdot \frac{\tanh(r)}{r}$$
$$y \leftarrow y \cdot \frac{\tanh(r)}{r}$$

이렇게 하면 결과가 항상 푸앵카레 볼 내부에 유지된다.

## 1.7. 생물학적 영감: 뇌의 기하학

### 1.7.1. 신경과학에서의 쌍곡기하학

최근 신경과학 연구에 따르면, 뇌의 특정 영역(특히 해마)에서 **그리드 셀(grid cell)**들이 쌍곡기하학적 패턴을 보인다는 증거가 발견되었다.

**그리드 셀의 특징:**
- 공간 위치를 인코딩하는 신경세포
- 삼각격자 형태의 활성화 패턴
- 경계 근처에서 활성화 밀도 급증

이는 우리의 푸앵카레 볼 모델과 놀라울 정도로 유사하다.

### 1.7.2. 인지적 거리와 쌍곡거리

심리학 실험에서 발견된 **인지적 거리(cognitive distance)**는 물리적 거리와 다르다:

- 친숙한 장소: 실제보다 가깝게 느껴짐
- 낯선 장소: 실제보다 멀게 느껴짐
- 계층적 관계: 상하관계가 있는 개념들 사이의 거리

이러한 특성들이 푸앵카레 볼의 거리 왜곡과 일치한다.

## 1.8. 결론: 새로운 패러다임의 시작

푸앵카레 볼 기반 데이터 구조는 단순한 압축 기법을 넘어선다. 이는 **계산의 기하학적 기반**을 유클리드에서 쌍곡으로 전환하는 근본적인 패러다임 변화이다.

### 1.8.1. 핵심 성과 요약

| 측면 | 기존 방식 | 푸앵카레 볼 방식 | 개선 효과 |
|:-----|:---------|:---------------|:---------|
| **정보 밀도** | 선형 증가 | 기하급수적 증가 | 최대 25만배 |
| **메모리 사용** | 전체 행렬 저장 | 128비트만 저장 | 93.75% 절약 |
| **하드웨어 친화성** | 복잡한 부동소수점 | CORDIC 비트연산 | 극적 단순화 |
| **학습 능력** | 수치 미분 | 상태 전이 | 안정성 향상 |

### 1.8.2. 향후 전망

푸앵카레 볼 기반 RBE는 다음과 같은 영향을 미칠 것으로 예상된다:

1. **모바일 AI**: 스마트폰에서 GPT급 모델 실행
2. **에지 컴퓨팅**: IoT 디바이스에서 복잡한 AI 작업
3. **과학 계산**: 대규모 시뮬레이션의 메모리 효율성
4. **양자 컴퓨팅**: 쌍곡기하학과 양자역학의 자연스러운 연결

이는 **계산의 기하학적 혁명**의 시작에 불과하다. 다음 장에서는 이러한 수학적 구조를 실제 데이터로 어떻게 인코딩하는지 살펴볼 것이다. 