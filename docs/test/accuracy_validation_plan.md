# RBE 레이어 정확도 검증 계획

## 1. 검증 목표
RBE 압축 기술이 원본 가중치와 비교하여 얼마나 정확한지 검증

## 2. 검증 메트릭
- **RMSE (Root Mean Square Error)**: 압축/복원 오차
- **상대 오차 (Relative Error)**: 원본 대비 오차 비율
- **코사인 유사도**: 벡터 방향 유지 정도
- **최대 절대 오차**: 최악의 경우 오차

## 3. 검증 대상 레이어

### 3.1 RBELinear
- 랜덤 가중치 vs 압축/복원 가중치
- 순전파 출력 비교
- 다양한 크기 테스트 (768x768, 768x3072, 3072x768)

### 3.2 RBEEmbedding  
- 토큰 임베딩 정확도
- 위치 임베딩 정확도
- 임베딩 조합 후 출력 검증

### 3.3 RBELayerNorm
- 정규화 출력 비교
- 수치적 안정성 검증
- Kahan summation 정확도

### 3.4 RBEFFN
- GELU 활성화 전후 비교
- 2단계 변환 정확도
- 다양한 활성화 함수 테스트

### 3.5 RBEAttention
- Q, K, V 프로젝션 정확도
- 어텐션 스코어 계산 정확도
- 멀티헤드 출력 검증

### 3.6 RBERMSNorm
- RMS 계산 정확도
- 병렬 vs 순차 처리 일치성
- 배치 처리 정확도

### 3.7 RBEDropout
- 통계적 특성 검증 (평균, 분산)
- 드롭아웃 비율 정확도
- 푸앵카레 거리 기반 패턴 검증

### 3.8 RBESoftmax
- 확률 분포 검증 (합=1)
- 수치적 안정성
- 온도 파라미터 영향

## 4. 품질 등급별 검증
- S등급: RMSE < 0.0001
- A등급: RMSE < 0.001  
- B등급: RMSE < 0.01
- C등급: RMSE < 0.1

## 5. 검증 방법

### 5.1 단위 테스트
- 각 레이어별 정확도 테스트
- 경계값 테스트
- 극한값 테스트

### 5.2 통합 테스트
- 레이어 체인 테스트
- 실제 모델 가중치 로드 테스트
- End-to-end 추론 테스트

### 5.3 벤치마크
- PyTorch/Candle 구현과 비교
- 속도 vs 정확도 트레이드오프
- 메모리 vs 정확도 트레이드오프

## 6. 허용 오차 기준
- 선형 레이어: 상대 오차 < 1%
- 정규화 레이어: 절대 오차 < 0.001
- 활성화 함수: 상대 오차 < 0.1%
- 어텐션: 코사인 유사도 > 0.999

## 7. 구현 순서
1. 정확도 측정 유틸리티 함수 구현
2. 각 레이어별 정확도 테스트 구현
3. 통합 정확도 벤치마크 구현
4. Candle과의 비교 검증
5. 결과 리포트 생성 