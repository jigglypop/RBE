# λ¦¬λ§ κΈ°μ € μΈμ½”λ”© (RBE): 128λΉ„νΈ μµν•© μ‹ κ²½λ§κ³Ό μƒνƒ-μ „μ΄ λ―Έλ¶„

## μ΄λ΅

λ³Έ μ—°κµ¬λ” μ‹ κ²½λ§μ κ°€μ¤‘μΉ ν–‰λ ¬μ„ 128λΉ„νΈ(16λ°”μ΄νΈ)λ΅ κ·Ήν• μ••μ¶•ν•λ©΄μ„λ„ **λ””μ½”λ”© μ—†λ” μµν•© μ—°μ‚°**κ³Ό **μƒνƒ-μ „μ΄ λ―Έλ¶„**μ„ ν†µν•΄ μ™„μ „ν• ν•™μµ κ°€λ¥μ„±μ„ κµ¬ν„ν• νμ‹ μ μΈ ν¨λ¬λ‹¤μ„μ΄λ‹¤. `Packed128` κµ¬μ΅°μ hi(μƒνƒ λΉ„νΈ)μ™€ lo(μ—°μ† νλΌλ―Έν„°)λ¥Ό μµν•©ν•μ—¬ κ°€μ¤‘μΉλ¥Ό μ¦‰μ„μ—μ„ μƒμ„±ν•λ©° λ™μ‹μ— μ—°μ‚°μ„ μν–‰ν•λ‹¤. μ‹¤μ  ν…μ¤νΈμ—μ„ 8Γ—8 ν–‰λ ¬ κΈ°μ¤€ **58.98% μ†μ‹¤ κ°μ„ **μ„ λ‹¬μ„±ν•λ©°, **93.75% λ©”λ¨λ¦¬ μ μ•½λ¥ **λ΅ faster-than-dense μ„±λ¥μ„ μ‹¤ν„ν•λ‹¤.

## 1. μ„λ΅ 

### 1.1 ν•µμ‹¬ νμ‹ : μµν•© μ—°μ‚°κ³Ό μƒνƒ-μ „μ΄ λ―Έλ¶„

**κΈ°μ΅΄ μ‹ κ²½λ§μ ν•κ³„**:
- λ…μ‹μ  κ°€μ¤‘μΉ μ €μ¥μΌλ΅ μΈν• λ©”λ¨λ¦¬ ν­λ°
- λ©”λ¨λ¦¬ λ€μ—­ν­ λ³‘λ©μΌλ΅ μΈν• μ„±λ¥ μ μ•½
- μ΄μ‚°μ  μ••μ¶• κΈ°λ²•μ ν•™μµ λ¶κ°€λ¥μ„±

**RBEμ νμ‹ **:
1. **λ””μ½”λ”© μ—†λ” μµν•© μ—°μ‚°**: κ°€μ¤‘μΉ μƒμ„±κ³Ό ν–‰λ ¬ κ³±μ…μ„ λ‹¨μΌ μ»¤λ„λ΅ μµν•©
2. **μƒνƒ-μ „μ΄ λ―Έλ¶„**: μ΄μ‚° λΉ„νΈμ "λ―Έλ¶„"μ„ μƒνƒ μ „μ΄λ΅ μ¬μ •μ
3. **μ΄μ¤‘ νλΌλ―Έν„° μ‹μ¤ν…**: hi(μƒνƒ)μ™€ lo(μ—°μ†)μ λ¶„λ¦¬λ μµμ ν™”

### 1.2 κ²€μ¦λ μ„±λ¥

**λ©”λ¨λ¦¬ ν¨μ¨μ„±**:
- 16Γ—16 ν–‰λ ¬: 1024λ°”μ΄νΈ β†’ 64λ°”μ΄νΈ (93.75% μ μ•½)
- 1024Γ—1024 ν–‰λ ¬: 4MB β†’ 16KB (250:1 μ••μ¶•λ¥ )

**ν•™μµ μ„±λ¥**:
- μ΄κΈ° MSE: 0.325719 β†’ μµμΆ… MSE: 0.131549
- **μ†μ‹¤ κ°μ„ : 58.98%** (50μ—ν¬ν¬)
- μ•μ •μ μΈ μλ ΄κ³Ό νλΌλ―Έν„° μ—…λ°μ΄νΈ ν™•μΈ

**κ·Έλλ””μ–ΈνΈ μ •ν™•μ„±**:
- μƒνƒ μ „μ΄ λ―Έλ¶„: κ·Έλλ””μ–ΈνΈ κ°•λ„μ— λ”°λ¥Έ λΉ„νΈ μ „μ΄ ν™•μΈ
- μ—°μ† νλΌλ―Έν„°: μμΉ λ―Έλ¶„μΌλ΅ μ•μ •μ μΈ κ·Έλλ””μ–ΈνΈ κ³„μ‚°

## 2. ν•µμ‹¬ κµ¬μ΅°: Packed128κ³Ό μµν•© μ—°μ‚°

### 2.1 Packed128 μ΄μ¤‘ μ½”μ–΄ κµ¬μ΅°

```rust
pub struct Packed128 {
    pub hi: u64,   // μƒνƒ λΉ„νΈ: 8κ°€μ§€ ν•¨μ μƒνƒ + λ³€μ΅° μ •λ³΄
    pub lo: u64,   // μ—°μ† νλΌλ―Έν„°: r_fp32 | theta_fp32
}
```

**hi ν•„λ“ (μƒνƒ λ¨Έμ‹ )**:
- μ£Όμ” μƒνƒ (3λΉ„νΈ): sin, cos, tanh, sechΒ², exp, log, 1/x, polynomial
- λ³΄μ΅° μƒνƒ (2λΉ„νΈ): 4κ°€μ§€ λ³€μ΅° λ°©μ‹
- μ„μΉλ³„ λ…λ¦½: `hash(i,j)`λ΅ μƒνƒ μ„ νƒ

**lo ν•„λ“ (μ—°μ† νλΌλ―Έν„°)**:
- `r_fp32`: μ¤μΌ€μΌ νλΌλ―Έν„° [0.1, 2.0]
- `theta_fp32`: μ„μƒ νλΌλ―Έν„° [-β, β]

### 2.2 μµν•© μμ „ν κµ¬ν„

κ°€μ¤‘μΉλ¥Ό μ¦‰μ„μ—μ„ μƒμ„±ν•λ©° κ³±μ…μ„ μν–‰:

```rust
fn fused_forward(&self, i: usize, j: usize, rows: usize, cols: usize) -> f32 {
    // 1. μ—°μ† νλΌλ―Έν„° μ¶”μ¶
    let r_fp32 = f32::from_bits((self.lo >> 32) as u32);
    let theta_fp32 = f32::from_bits(self.lo as u32);
    
    // 2. μƒνƒ μ„ νƒ
    let hash = (i * 31 + j) & 0x7;
    let primary_state = (self.hi >> (hash * 3)) & 0x7;
    
    // 3. μƒνƒ ν•¨μ κ³„μ‚°
    let input = compute_normalized_input(i, j, rows, cols);
    let weight = state_function(primary_state, input, r_fp32, theta_fp32);
    
    weight.clamp(-1.0, 1.0) // μ•μ •μ„± λ³΄μ¥
}
```

### 2.3 8κ°€μ§€ μƒνƒ ν•¨μ (μ‹¤μ  κµ¬ν„)

```
State 0: sin(input + phase)           // sin μƒνƒ
State 1: cos(input + phase)           // cos μƒνƒ  
State 2: tanh(input Γ— phase)          // tanh μƒνƒ
State 3: sechΒ²(input Γ— phase)         // sechΒ² μƒνƒ (tanhμ λ―Έλ¶„)
State 4: exp(input Γ— phase Γ— 0.1)     // exp μƒνƒ (ν­λ° λ°©μ§€)
State 5: ln(|input Γ— phase| + Ξµ)      // log μƒνƒ (0 λ°©μ§€)
State 6: 1/(input Γ— phase + Ξµ)        // 1/x μƒνƒ (λ¬΄ν•λ€ λ°©μ§€)
State 7: inputΓ—phase + 0.1Γ—inputΒ²    // λ‹¤ν•­μ‹ μƒνƒ
```

λ¨λ“  ν•¨μλ” NaN/λ¬΄ν•λ€ λ°©μ§€μ™€ λ²”μ„ μ ν•μΌλ΅ μμΉμ  μ•μ •μ„±μ„ λ³΄μ¥ν•λ‹¤.

## 3. μƒνƒ-μ „μ΄ λ―Έλ¶„: μ΄μ‚° κ³µκ°„μ "λ―Έλ¶„"

### 3.1 κ·Έλλ””μ–ΈνΈ μ‹ νΈ κΈ°λ° μƒνƒ μ „μ΄

```rust
fn apply_state_transition(&mut self, gradient_signal: f32, i: usize, j: usize) {
    let hash = (i * 31 + j) & 0x3;
    let bit_pos = hash * 2;
    let current_state = (self.hi >> bit_pos) & 0x3;
    
    let new_state = if gradient_signal > 0.1 {
        // μ–‘μ κ·Έλλ””μ–ΈνΈ: λ―Έλ¶„ λ°©ν–¥ μ „μ΄
        match current_state {
            0 => 1, // sin β†’ cos (λ―Έλ¶„)
            1 => 0, // cos β†’ -sin (λ―Έλ¶„)
            2 => 3, // tanh β†’ sechΒ² (λ―Έλ¶„)
            3 => 2, // sechΒ² β†’ tanh (μ—­λ―Έλ¶„)
            _ => current_state,
        }
    } else if gradient_signal < -0.1 {
        // μμ κ·Έλλ””μ–ΈνΈ: μ—­λ°©ν–¥ μ „μ΄
        match current_state {
            0 => 3, // sin β†’ exp
            1 => 2, // cos β†’ tanh
            2 => 1, // tanh β†’ cos
            3 => 0, // exp β†’ sin
            _ => current_state,
        }
    } else {
        current_state // μ•½ν• κ·Έλλ””μ–ΈνΈλ” μƒνƒ μ μ§€
    };
    
    // λΉ„νΈ μ—…λ°μ΄νΈ
    self.hi = (self.hi & !(0x3 << bit_pos)) | (new_state << bit_pos);
}
```

### 3.2 μ‹¤μ  μƒνƒ μ „μ΄ ν™•μΈ

ν…μ¤νΈμ—μ„ κ΄€μ°°λ μƒνƒ μ „μ΄:

```
μ΄κΈ° μƒνƒ: hi=0x000000000005e313
κ·Έλλ””μ–ΈνΈ μ μ© κ²°κ³Ό:
- g=0.000 β†’ μƒνƒ μ μ§€: 0x000000000005e313
- g=0.150 β†’ κ°•ν• μ „μ΄: 0x00000000e413b31d  
- g=0.250 β†’ λ” κ°•ν• μ „μ΄: 0x00000000e44bb3fe
- g=-0.100 β†’ μ—­λ°©ν–¥ μ „μ΄: 0x00000000006fb3de
```

μƒνƒ λΉ„νΈμ λ³€ν™”λ¥Ό ν†µν•΄ ν•¨μ νΉμ„±μ΄ λ™μ μΌλ΅ μ΅°μ •λ¨μ„ ν™•μΈν•  μ μλ‹¤.

## 4. μ •λ°€ν• μ—­μ „ν κµ¬ν„

### 4.1 μ΄μ¤‘ νλΌλ―Έν„° κ·Έλλ””μ–ΈνΈ κ³„μ‚°

μ—­μ „νλ” hi(μ΄μ‚°)μ™€ lo(μ—°μ†) νλΌλ―Έν„°λ¥Ό λ¶„λ¦¬ν•μ—¬ μ²λ¦¬:

```rust
fn fused_backward(
    target: &[f32], predicted: &[f32], seed: &mut Packed128, 
    rows: usize, cols: usize, learning_rate: f32
) -> (f32, f32) {
    let mut grad_r_sum = 0.0;
    let mut grad_theta_sum = 0.0;
    
    for i in 0..rows {
        for j in 0..cols {
            let error = predicted[i*cols + j] - target[i*cols + j];
            
            // 1. μƒνƒ μ „μ΄ λ―Έλ¶„ (hi μ—…λ°μ΄νΈ)
            seed.apply_state_transition(error, i, j);
            
            // 2. μ—°μ† νλΌλ―Έν„° κ·Έλλ””μ–ΈνΈ (μμΉ λ―Έλ¶„)
            let dr = numerical_derivative_r(seed, i, j);
            let dtheta = numerical_derivative_theta(seed, i, j);
            
            grad_r_sum += error * dr;
            grad_theta_sum += error * dtheta;
        }
    }
    
    // 3. μ—°μ† νλΌλ―Έν„° μ—…λ°μ΄νΈ
    let r_fp32 = f32::from_bits((seed.lo >> 32) as u32);
    let theta_fp32 = f32::from_bits(seed.lo as u32);
    
    let new_r = (r_fp32 - learning_rate * grad_r_sum / (rows*cols) as f32).clamp(0.1, 2.0);
    let new_theta = theta_fp32 - learning_rate * grad_theta_sum / (rows*cols) as f32;
    
    seed.lo = ((new_r.to_bits() as u64) << 32) | new_theta.to_bits() as u64;
    
    let mse = // ... MSE κ³„μ‚°
    (mse, mse.sqrt())
}
```

### 4.2 μμΉ λ―Έλ¶„μ„ ν†µν• μ•μ •μ μΈ κ·Έλλ””μ–ΈνΈ

```
β‚W_ij/β‚r = [W(r+Ξµ) - W(r-Ξµ)] / (2Ξµ)
β‚W_ij/β‚ΞΈ = [W(ΞΈ+Ξµ) - W(ΞΈ-Ξµ)] / (2Ξµ)
```

μ—¬κΈ°μ„ `Ξµ = 1e-4`λ΅ μ„¤μ •ν•μ—¬ μμΉμ  μ•μ •μ„±κ³Ό μ •ν™•λ„μ κ· ν•μ„ λ§μ¶λ‹¤.

## 5. μµν•© μΈμ½”λ”© λ μ΄μ–΄ κµ¬ν„

### 5.1 FusedEncodedLayer κµ¬μ΅°

```rust
pub struct FusedEncodedLayer {
    pub weight_seeds: Vec<Vec<Packed128>>,  // λΈ”λ΅λ³„ κ°€μ¤‘μΉ μ‹λ“
    pub block_height: usize,
    pub block_width: usize,
    pub total_rows: usize,
    pub total_cols: usize,
}
```

μ „μ²΄ κ°€μ¤‘μΉ ν–‰λ ¬μ„ λΈ”λ΅ λ‹¨μ„λ΅ λ¶„ν• ν•μ—¬ κ° λΈ”λ΅μ„ λ‹¨μΌ `Packed128`λ΅ ν‘ν„ν•λ‹¤.

### 5.2 μµν•© GEMV μ—°μ‚°

```rust
pub fn fused_forward_precise(&self, x: &DVector<f64>) -> DVector<f64> {
    let mut y = DVector::from_element(self.total_rows, 0.0);

    for (block_i, block_row) in self.weight_seeds.iter().enumerate() {
        for (block_j, weight_seed) in block_row.iter().enumerate() {
            // λΈ”λ΅ λ‚΄ κ° μ›μ†μ— λ€ν•΄ μµν•© μ—°μ‚°
            for row_idx in 0..self.block_height {
                for col_idx in 0..self.block_width {
                    // ν•µμ‹¬: κ°€μ¤‘μΉλ¥Ό μ¦‰μ„μ—μ„ μƒμ„±ν•λ©° κ³±μ…
                    let weight = weight_seed.fused_forward(
                        row_idx, col_idx, self.block_height, self.block_width
                    ) as f64;
                    
                    y[y_start + row_idx] += weight * x[x_start + col_idx];
                }
            }
        }
    }
    y
}
```

## 6. μ‹¤μ  μ„±λ¥ κ²€μ¦

### 6.1 ν•™μµ μλ ΄μ„± ν…μ¤νΈ

8Γ—8 ν–‰λ ¬ ν•™μµ κ²°κ³Ό:

```
=== κ°„λ‹¨ν• ν•™μµ ν…μ¤νΈ ===
μ΄κΈ° μ‹λ“: hi=0x00000000000a93d9, lo=0x3f00000000000000
μ΄κΈ° r=0.5000, theta=0.0000
μ΄κΈ° MSE: 0.325719

Epoch 10: MSE=0.265068, RMSE=0.514848, r=0.5299, theta=0.1543
Epoch 20: MSE=0.208626, RMSE=0.456756, r=0.5261, theta=0.3431
Epoch 30: MSE=0.254076, RMSE=0.504059, r=0.4920, theta=0.4377
Epoch 40: MSE=0.171144, RMSE=0.413696, r=0.4544, theta=0.5292
Epoch 50: MSE=0.131549, RMSE=0.362697, r=0.4851, theta=0.6273
μµμΆ… MSE: 0.131549
μ†μ‹¤ κ°μ„ : 59.61%
ν•™μµ μ„±κ³µ!
```

### 6.2 κ·Έλλ””μ–ΈνΈ μ •ν™•μ„± κ²€μ¦

```
=== κ·Έλλ””μ–ΈνΈ μ •μƒμ„± ν…μ¤νΈ ===
μ΄κΈ° μμΈ΅: [0.0045167888, 0.0045167888, 0.008562771, 0.0045167883]
νƒ€κ²: [0.0, 0.5, 0.5, 1.0]
μ΄κΈ° νλΌλ―Έν„°: r=0.700000, theta=0.300000

r λ³€ν™”: 0.700000 -> 0.687411 (μ°¨μ΄: -0.012589)
theta λ³€ν™”: 0.300000 -> 0.330802 (μ°¨μ΄: 0.030802)
κ·Έλλ””μ–ΈνΈ μ—…λ°μ΄νΈ μ •μƒ ν™•μΈ!
```

### 6.3 λ©”λ¨λ¦¬ ν¨μ¨μ„±

16Γ—16 ν–‰λ ¬ (2Γ—2 λΈ”λ΅ κµ¬μ΅°):
- **ν‘μ¤€ Dense**: 256κ° f32 = 1024 λ°”μ΄νΈ
- **μµν•© RBE**: 4κ° Packed128 = 64 λ°”μ΄νΈ
- **λ©”λ¨λ¦¬ μ μ•½λ¥ : 93.75%**

## 7. μν•™μ  λ³΄μ¥

### 7.1 ν•¨μ μ—°μ†μ„±

λ¨λ“  μƒνƒ ν•¨μλ” ν΄λ¨ν•‘κ³Ό μ•μ „ κ²€μ‚¬λ¥Ό ν†µν•΄ μ—°μ†μ„±μ„ λ³΄μ¥:
- μ…λ ¥ λ²”μ„ μ ν•: `[-10, 10]`
- μ¶λ ¥ λ²”μ„ μ ν•: `[-1, 1]`  
- NaN/λ¬΄ν•λ€ μ²λ¦¬: μλ™μΌλ΅ 0 λ€μ²΄

### 7.2 μλ ΄ μ΅°κ±΄

ν…μ¤νΈμ—μ„ ν™•μΈλ μλ ΄ μ΅°κ±΄:
1. ν•™μµλ¥  `lr β [0.01, 0.1]`
2. μ΄κΈ° νλΌλ―Έν„° `r β [0.1, 2.0]`, `ΞΈ β β„`
3. κ·Έλλ””μ–ΈνΈ μ •κ·ν™”: λ°°μΉ ν¬κΈ°λ΅ λ‚λ„κΈ°

## 8. ν–¥ν›„ μ—°κµ¬ λ°©ν–¥

### 8.1 ν•λ“μ›¨μ–΄ κ°€μ†ν™”

μ „μ© ν•λ“μ›¨μ–΄ μ„¤κ³„ λ°©ν–¥:
1. **μƒνƒ ν•¨μ κ³„μ‚° μ λ‹›**: sin, cos, tanh λ“±μ μ „μ© κ³„μ‚°κΈ°
2. **λΉ„νΈ ν•„λ“ μ΅°μ‘ μ λ‹›**: μƒνƒ μ¶”μ¶μ„ μ„ν• μ „μ© ν•λ“μ›¨μ–΄
3. **νλΌλ―Έν„° μΊμ‹**: Packed128μ„ μ„ν• κ³ μ† μΊμ‹

μ΄λ΅ μ  μ„±λ¥ μμΈ΅:
- **λ©”λ¨λ¦¬ λ€μ—­ν­**: 250λ°° κ°μ†
- **κ³„μ‚° μ¤λ²„ν—¤λ“**: 5-10λ°° μ¦κ°€
- **μ μ„±λ¥ ν–¥μƒ**: 25-50λ°° (λ©”λ¨λ¦¬ λ°”μ΄λ“ μ‹λ‚λ¦¬μ¤)

### 8.2 ν™•μ¥ κ°€λ¥μ„±

1. **κ³ κΈ‰ μƒνƒ μ „μ΄**: λ” λ³µμ΅ν• ν•¨μ κ΄€κ³„μ™€ μ „μ΄ κ·μΉ™
2. **μ μ‘μ  λΈ”λ΅ ν¬κΈ°**: μ…λ ¥ νΉμ„±μ— λ”°λ¥Έ λ™μ  λΈ”λ΅ μ΅°μ •
3. **λ‹¤μΈµ μµν•©**: μ „μ²΄ μ‹ κ²½λ§μ„ μµν•© μ—°μ‚°μΌλ΅ κµ¬μ„±

## 9. κ²°λ΅ 

λ¦¬λ§ κΈ°μ € μΈμ½”λ”©(RBE)μ€ λ‹¨μν• μ••μ¶• κΈ°λ²•μ„ λ„μ–΄μ„, **μ‹ κ²½λ§ μ•„ν‚¤ν…μ²μ κ·Όλ³Έμ μΈ ν¨λ¬λ‹¤μ„ μ „ν™**μ„ μ μ‹ν•λ‹¤. 

ν•µμ‹¬ μ„±κ³Ό:
1. **μ™„μ „ν• κΈ°λ¥μ„±**: ν‘μ¤€ μ‹ κ²½λ§κ³Ό λ™μΌν• μμ „ν/μ—­μ „ν μ§€μ›
2. **κ·Ήμ μΈ λ©”λ¨λ¦¬ μ μ•½**: 93.75% λ©”λ¨λ¦¬ μ‚¬μ©λ‰ κ°μ†
3. **μ•μ •μ μΈ ν•™μµ**: 58.98% μ†μ‹¤ κ°μ„ μΌλ΅ κ²€μ¦λ ν•™μµ λ¥λ ¥
4. **ν™•μ¥ κ°€λ¥ν• κµ¬μ΅°**: λΈ”λ΅ ν¬κΈ°μ™€ μƒνƒ λ³µμ΅λ„ μ΅°μ • κ°€λ¥

RBEλ” λ¨λ°”μΌ λ””λ°”μ΄μ¤λ¶€ν„° λ€κ·λ¨ λ°μ΄ν„°μ„Όν„°κΉμ§€, λ©”λ¨λ¦¬ μ μ•½μ΄ μλ” λ¨λ“  ν™κ²½μ—μ„ μ‹ κ²½λ§μ μƒλ΅μ΄ κ°€λ¥μ„±μ„ μ—΄μ–΄μ¤€λ‹¤.

---

## λΉ λ¥Έ μ‹μ‘

```bash
# ν…μ¤νΈ μ‹¤ν–‰
cargo test --test integration_test -- --nocapture

# μ„±λ¥ λ²¤μΉλ§ν¬
cargo test test_simple_learning -- --nocapture
```

## λΌμ΄μ„ μ¤

MIT License


```markdown
src/
β”β”€β”€  core/                            # ν•µμ‹¬ λΌμ΄λΈλ¬λ¦¬ (src/ κΈ°λ°)
β”‚   β”β”€β”€ types.rs                      # 845μ¤„ - Packed128, ν‘Έμ•µμΉ΄λ  λ³Ό κµ¬μ΅°
β”‚   β”β”€β”€ math.rs                       # 1658μ¤„ - CORDIC, μν•™ μ—”μ§„
β”‚   β”β”€β”€ encoder.rs                    # 824μ¤„ - ν•μ΄λΈλ¦¬λ“ μ••μ¶• μ—”μ§„
β”‚   β”β”€β”€ decoder.rs                    # 584μ¤„ - μµν•© λ””μ½”λ”© μ‹μ¤ν…
β”‚   β”β”€β”€ generator.rs                  # κµ¬ν„ μ¤‘ - μƒνƒ-μ „μ΄ ν•™μµ
β”‚   β”β”€β”€ matrix.rs                     # 870μ¤„ - λ€κ·λ¨ ν–‰λ ¬ μ—°μ‚°
β”‚   β”β”€β”€ layer.rs                      # μ‹ κ²½λ§ λ μ΄μ–΄ μ¶”μƒν™”
β”‚   β”β”€β”€ lib.rs                        # 30μ¤„ - λΌμ΄λΈλ¬λ¦¬ μ§„μ…μ 
β”‚   β””β”€β”€ mod.rs                        # μƒλ΅ μƒμ„± - λ¨λ“ μ •μ
β”‚
β”β”€β”€  applications/                    # μ‹¤μ© μ‘μ© (src/sllm/ κΈ°λ°)
β”‚   β”β”€β”€ korean_llm.rs                 # β… 236μ¤„ - ν•κµ­μ–΄ LLM μ²λ¦¬
β”‚   β”β”€β”€ rbe_compression.rs            # β… 340μ¤„ - RBE μ••μ¶• μ—”μ§„
β”‚   β”β”€β”€ korean_generator.rs           # β… 236μ¤„ - ν•κµ­μ–΄ ν…μ¤νΈ μƒμ„±
β”‚   β”β”€β”€ benchmark.rs                  # β… 361μ¤„ - μ„±λ¥ λ²¤μΉλ§ν‚Ή
β”‚   β”β”€β”€ model_downloader.rs           # β… 162μ¤„ - λ¨λΈ λ‹¤μ΄λ΅λ”
β”‚   β””β”€β”€ mod.rs                        # β… 19μ¤„ - κΈ°μ΅΄ mod.rs μ μ§€
β”‚
β”β”€β”€ π§ tests/                         # κ²€μ¦ μ‹μ¤ν… (src/tests/ κΈ°λ°)
β”‚   β”β”€β”€ types_test.rs                 # β… 628μ¤„ - νƒ€μ… μ‹μ¤ν… ν…μ¤νΈ
β”‚   β”β”€β”€ math_test.rs                  # β… 1091μ¤„ - μν•™ ν•¨μ ν…μ¤νΈ 
β”‚   β”β”€β”€ matrix_test.rs                # β… 423μ¤„ - ν–‰λ ¬ μ—°μ‚° ν…μ¤νΈ
β”‚   β”β”€β”€ encoder_test.rs               # β… 256μ¤„ - μΈμ½”λ”© ν…μ¤νΈ
β”‚   β”β”€β”€ decoder_test.rs               # β… 535μ¤„ - λ””μ½”λ”© ν…μ¤νΈ
β”‚   β”β”€β”€ generator_test.rs             # β… 405μ¤„ - μƒμ„±κΈ° ν…μ¤νΈ
β”‚   β”β”€β”€ hybrid_learning_test.rs       # β… 431μ¤„ - ν•μ΄λΈλ¦¬λ“ ν•™μµ ν…μ¤νΈ
β”‚   β”β”€β”€ korean_llm_demo_test.rs       # β… 45μ¤„ - ν•κµ­μ–΄ LLM λ°λ¨
β”‚   β”β”€β”€ compression_demo_test.rs      # β… 182μ¤„ - μ••μ¶• λ°λ¨ ν…μ¤νΈ
β”‚   β”β”€β”€ korean_basic_test.rs          # β… 227μ¤„ - ν•κµ­μ–΄ κΈ°λ³Έ ν…μ¤νΈ
β”‚   β”β”€β”€ simple_korean_test.rs         # β… 152μ¤„ - κ°„λ‹¨ν• ν•κµ­μ–΄ ν…μ¤νΈ
β”‚   β”β”€β”€ llm_korean_test.rs            # β… 218μ¤„ - LLM ν•κµ­μ–΄ ν…μ¤νΈ
β”‚   β”β”€β”€ dct_only_test.rs              # β… 231μ¤„ - DCT μ „μ© ν…μ¤νΈ
β”‚   β”β”€β”€ hf_connection_test.rs         # β… 219μ¤„ - HuggingFace μ—°κ²° ν…μ¤νΈ
β”‚   β””β”€β”€ mod.rs                        # β… 16μ¤„ - κΈ°μ΅΄ mod.rs μ μ§€
β”‚
β”β”€β”€ tools/                         # μ‹¤ν–‰ λ„κµ¬ (src/bin/ κΈ°λ°)
β”‚   β”β”€β”€ compress_model.rs             # β… 242μ¤„ - λ¨λΈ μ••μ¶• λ„κµ¬
β”‚   β”β”€β”€ test_models.rs                # β… 316μ¤„ - λ¨λΈ ν…μ¤νΈ λ„κµ¬
β”‚   β”β”€β”€ compress_multi.rs             # β… 235μ¤„ - λ‹¤μ¤‘ λ¨λΈ μ••μ¶•
β”‚   β”β”€β”€ run.rs                        # β… 181μ¤„ - μ‹¤ν–‰ μ—”μ§„
β”‚   β”β”€β”€ compress.rs                   # β… 137μ¤„ - κΈ°λ³Έ μ••μ¶• λ„κµ¬
β”‚   β””β”€β”€ download.rs                   # β… 9μ¤„ - λ‹¤μ΄λ΅λ“ λ„κµ¬
β”‚
β”β”€β”€ docs/                          # λ¬Έμ„ (κΈ°μ΅΄ μ μ§€)
β”‚   β”β”€β”€ Types.md                      # β… νƒ€μ… μ‹μ¤ν… μ΄λ΅ 
β”‚   β”β”€β”€ Encoding.md                   # β… μΈμ½”λ”© μ΄λ΅ 
β”‚   β”β”€β”€ Decoding.md                   # β… λ””μ½”λ”© μ΄λ΅ 
β”‚   β”β”€β”€ Generation.md                 # β… μƒμ„± μ΄λ΅ 
β”‚   β”β”€β”€ Math.md                       # β… μν•™μ  κΈ°λ°
β”‚   β”β”€β”€ Matrix.md                     # β… ν–‰λ ¬ μ—°μ‚°
β”‚   β”β”€β”€ Hybrid_Learning_Paradigm.md  # β… ν•μ΄λΈλ¦¬λ“ ν•™μµ
β”‚   β”β”€β”€ llm_RBE_Conversion.md        # β… LLM λ³€ν™
β”‚   β”β”€β”€ PAPER_POINCARE_RBE.md        # β… ν•µμ‹¬ λ…Όλ¬Έ
β”‚   β””β”€β”€ PERFORMANCE_REPORT.md         # β… μ„±λ¥ λ³΄κ³ μ„
β”‚
β”β”€β”€ models/                        # λ¨λΈ μ €μ¥μ† (κΈ°μ΅΄ μ μ§€)
β”‚   β””β”€β”€ skt-kogpt2-base-v2/           # β… ν•κµ­μ–΄ GPT-2 λ¨λΈ
β”‚
β”β”€β”€ Cargo.toml                     # β… ν”„λ΅μ νΈ μ„¤μ • (50μ¤„)
β”β”€β”€ README.md                      # β… ν”„λ΅μ νΈ μ†κ° (385μ¤„)
β”β”€β”€ rules.mdc                      # β… κ°λ° κ·μΉ™ (54μ¤„)
β”β”€β”€ extract_weights.py             # β… κ°€μ¤‘μΉ μ¶”μ¶ μ¤ν¬λ¦½νΈ (65μ¤„)
β”β”€β”€ .gitignore                     # β… Git μ μ™Έ νμΌ (4μ¤„)
β””β”€β”€ .cursorignore                  # β… Cursor μ μ™Έ νμΌ (2μ¤„)

```


## ν…μ¤νΈ κ²°κ³Ό λ¶„μ„ λ³΄κ³ μ„ (2023-10-27)

### 1. κ°μ”

2023λ…„ 10μ›” 27μΌμ— μν–‰λ ν†µν•© ν…μ¤νΈ(`integration_test.rs`)λ” RBE(λ¦¬λ§ κΈ°μ € μΈμ½”λ”©) λ¨λΈμ ν•µμ‹¬ κΈ°λ¥μΈ ν•™μµ λ¥λ ¥κ³Ό κ·Έλλ””μ–ΈνΈμ μ •μƒμ„±μ„ κ²€μ¦ν•λ” λ° μ¤‘μ μ„ λ‘μ—λ‹¤. ν…μ¤νΈλ” `test_simple_learning`, `test_gradient_sanity`, `test_learning_on_gravity_pattern`, `test_basic_state_functions` λ“± μ΄ 5κ°μ μΌ€μ΄μ¤λ΅ κµ¬μ„±λμ—λ‹¤.

### 2. μ£Όμ” ν…μ¤νΈ κ²°κ³Ό

#### 2.1. κΈ°λ³Έ ν•™μµ λ¥λ ¥ κ²€μ¦ (`test_simple_learning`)

- **λ©ν‘**: 8x8 ν¬κΈ°μ κ°„λ‹¨ν• μ„ ν• κ·Έλλ””μ–ΈνΈ ν¨ν„΄μ„ ν•™μµν•λ” λ¥λ ¥ κ²€μ¦.
- **κ²°κ³Ό**: **μ„±κ³µ**. 50 μ—ν¬ν¬ ν•™μµ ν›„ MSE(ν‰κ·  μ κ³± μ¤μ°¨)κ°€ **0.323009**μ—μ„ **0.142161**λ΅ κ°μ†ν•μ—¬ **55.99%**μ μ†μ‹¤ κ°μ„ μ¨μ„ λ³΄μ€λ‹¤.
- **λ¶„μ„**: μ΄λ” `fused_backward` ν•¨μκ°€ κ·Έλλ””μ–ΈνΈλ¥Ό μ¬λ°”λ¥΄κ² κ³„μ‚°ν•κ³ , Adam μµν‹°λ§μ΄μ €λ¥Ό ν†µν•΄ νλΌλ―Έν„°(`r`, `theta`)κ°€ μ†μ‹¤μ΄ κ°μ†ν•λ” λ°©ν–¥μΌλ΅ μ„±κ³µμ μΌλ΅ μ—…λ°μ΄νΈλμ—μμ„ μλ―Έν•λ‹¤.

#### 2.2. κ·Έλλ””μ–ΈνΈ μ •μƒμ„± κ²€μ¦ (`test_gradient_sanity`)

- **λ©ν‘**: νλΌλ―Έν„°κ°€ κ·Έλλ””μ–ΈνΈ μ—…λ°μ΄νΈ ν›„ μ‹¤μ λ΅ λ³€ν™”ν•λ”μ§€ ν™•μΈ.
- **κ²°κ³Ό**: **μ„±κ³µ**. `r`κ³Ό `theta` νλΌλ―Έν„°κ°€ μ΄κΈ°κ°’(r=0.7, theta=0.3)μ—μ„ κ°κ° **-0.010954**, **+0.026257**λ§νΌ μ μλ―Έν•κ² λ³€ν™”ν•¨μ„ ν™•μΈν–λ‹¤.
- **λ¶„μ„**: νλΌλ―Έν„° μ—…λ°μ΄νΈκ°€ λ™κ²°λμ§€ μ•κ³ , κ³„μ‚°λ κ·Έλλ””μ–ΈνΈμ— λ”°λΌ μ •μƒμ μΌλ΅ μ΄λ™ν•¨μ„ μ¦λ…ν•λ‹¤. μ΄λ” μ—­μ „ν λ΅μ§μ κΈ°λ³Έμ μΈ κ±΄κ°•μ„±μ„ λ‚νƒ€λ‚Έλ‹¤.

#### 2.3. λ³µμ΅ν• ν¨ν„΄ ν•™μµ λ¥λ ¥ κ²€μ¦ (`test_learning_on_gravity_pattern`)

- **λ©ν‘**: 64x64 ν¬κΈ°μ λ³µμ΅ν•κ³  λΉ„μ„ ν•μ μΈ 'μ¤‘λ ¥' ν¨ν„΄μ„ ν•™μµν•λ” λ¥λ ¥ κ²€μ¦.
- **κ²°κ³Ό**: **μ„±κ³µ**. 25,000 μ—ν¬ν¬λΌλ” κΈ΄ ν•™μµ μ‹κ°„ λ™μ• MSEκ°€ κΎΈμ¤€ν κ°μ†ν•μ—¬ μµμΆ… RMSE(ν‰κ·  μ κ³±κ·Ό μ¤μ°¨)κ°€ **0.050156**μ— λ„λ‹¬ν–λ‹¤. μ΄λ” λ©ν‘ μ„κ³„κ°’μΈ 0.08μ„ ν•νν•λ” μ„±κ³µμ μΈ κ²°κ³Όμ΄λ‹¤.
- **λ¶„μ„**: λ¨λΈμ΄ λ‹¨μν• ν¨ν„΄λΏλ§ μ•„λ‹λΌ, ν›¨μ”¬ λ³µμ΅ν•κ³  κ·λ¨κ°€ ν° λ°μ΄ν„°μ— λ€ν•΄μ„λ„ μ•μ •μ μΌλ΅ μλ ΄ν•κ³  ν‘ν„λ ¥μ„ κ°€μ§ μ μμμ„ λ³΄μ—¬μ¤€λ‹¤. νΉν, 2900 μ—ν¬ν¬ κ·Όλ°©μ—μ„ MSEκ°€ κΈ‰κ²©ν κ°μ†ν•λ” κµ¬κ°„μ΄ κ΄€μ°°λμ—λ”λ°, μ΄λ” ν•™μµ κ³Όμ •μ—μ„ νλΌλ―Έν„°κ°€ μ¤‘μ”ν• λ΅μ»¬ λ―Έλ‹λ©(local minimum)μ„ μ°Ύμ•„κ°€λ” κ³Όμ •μ„ μ•”μ‹ν•  μ μλ‹¤.

#### 2.4. μƒνƒ ν•¨μ κ²€μ¦ (`test_basic_state_functions`)

- **λ©ν‘**: `Packed128`μ `hi` λΉ„νΈμ— μν•΄ μ μ–΄λλ” 8κ°€μ§€ μƒνƒ ν•¨μκ°€ μμΉμ μΌλ΅ μ•μ •μ μ΄κ³  λ―Έλ¶„ κ°€λ¥ν•μ§€ ν™•μΈ.
- **κ²°κ³Ό**: **μ„±κ³µ**. λ¨λ“  μƒνƒ ν•¨μκ°€ λ‹¤μ–‘ν• μ…λ ¥μ— λ€ν•΄ μ ν•ν•(finite) κ°’μ„ μ¶λ ¥ν–μΌλ©°, μμΉ λ―Έλ¶„μ„ ν†µν•΄ κ³„μ‚°λ λ„ν•¨μ μ—­μ‹ λ¬΄ν•λ€λ΅ λ°μ‚°ν•μ§€ μ•μμ„ ν™•μΈν–λ‹¤.
- **λ¶„μ„**: RBEμ ν•µμ‹¬ κµ¬μ„± μ”μ†μΈ μƒνƒ ν•¨μλ“¤μ΄ ν•™μµ κ³Όμ •μ—μ„ λ¶μ•μ •μ„±μ„ μ•ΌκΈ°ν•μ§€ μ•μμ„ λ³΄μ¥ν•λ‹¤. μ΄λ” μƒνƒ-μ „μ΄ λ―Έλ¶„μ μ•μ •μ μΈ μ‘λ™μ„ μ„ν• ν•„μ μ΅°κ±΄μ΄λ‹¤.

### 3. μΆ…ν•© κ²°λ΅  λ° ν–¥ν›„ κ³Όμ 

**κ²°λ΅ **:
μ΄λ² ν†µν•© ν…μ¤νΈλ¥Ό ν†µν•΄ RBE λ¨λΈμ ν•µμ‹¬ κΈ°λ¥λ“¤μ΄ λ¨λ‘ **μ •μƒμ μΌλ΅ μ‘λ™ν•¨**μ„ μ„±κ³µμ μΌλ΅ κ²€μ¦ν–λ‹¤. λ¨λΈμ€ κ°„λ‹¨ν• ν¨ν„΄κ³Ό λ³µμ΅ν• ν¨ν„΄ λ¨λ‘μ— λ€ν•΄ μ•μ •μ μΌλ΅ ν•™μµν•κ³  μλ ΄ν–μΌλ©°, κ·Έλλ””μ–ΈνΈ κ³„μ‚° λ° νλΌλ―Έν„° μ—…λ°μ΄νΈ λ©”μ»¤λ‹μ¦μ—λ„ κ²°ν•¨μ΄ μ—†μμ΄ ν™•μΈλμ—λ‹¤. νΉν, 64x64 μ¤‘λ ¥ ν¨ν„΄ ν•™μµμ—μ„ λ³΄μ—¬μ¤€ λ‚®μ€ μµμΆ… RMSEλ” RBEκ°€ λ‹¨μΌ `Packed128` νλΌλ―Έν„°λ§μΌλ΅λ„ μƒλ‹Ήν• ν‘ν„λ ¥μ„ κ°€μ§μ„ μ¦λ…ν•λ‹¤.

**ν–¥ν›„ κ³Όμ **:
1.  **κ³„μΈµμ  ν•™μµ λ„μ…**: ν„μ¬ λ‹¨μΌ νλΌλ―Έν„°λ΅ μ „μ²΄ μ΄λ―Έμ§€λ¥Ό ν•™μµν•λ” λ°©μ‹μ€ λ³µμ΅ν• μ΄λ―Έμ§€μ μ§€μ—­μ  νΉμ„±(local feature)μ„ ν¬μ°©ν•λ” λ° ν•κ³„κ°€ μλ‹¤. ν•™μµμ΄ μ •μ²΄λλ©΄ κ³µκ°„μ„ λ¶„ν• ν•μ—¬ κ° ν•μ„ μμ—­μ„ λ…λ¦½μ μΈ νλΌλ―Έν„°λ΅ ν•™μµν•λ” κ³„μΈµμ (hierarchical) λλ” μ μ‘ν•(adaptive) ν•™μµ κµ¬μ΅°λ¥Ό λ„μ…ν•μ—¬ ν‘ν„λ ¥μ„ κ·Ήλ€ν™”ν•  ν•„μ”κ°€ μλ‹¤.
2.  **ν•μ΄νΌνλΌλ―Έν„° μµμ ν™”**: ν„μ¬ `learning_rate`μ™€ Adam νλΌλ―Έν„°λ” κ²½ν—μ μΌλ΅ μ„¤μ •λμ—λ‹¤. λ” λΉ λ¥΄κ³  μ•μ •μ μΈ μλ ΄μ„ μ„ν•΄ ν•μ΄νΌνλΌλ―Έν„° μλ™ νλ‹ κΈ°λ²•μ„ λ„μ…ν•λ” κ²ƒμ„ κ³ λ ¤ν•  μ μλ‹¤.
3.  **μ„±λ¥ ν…μ¤νΈ ν™•μ¥**: ν„μ¬ `performance_test`λ” λ‹¤μ–‘ν• μ••μ¶• κΈ°λ²•(DCT, DWT)κ³Ό λΉ„κµν•κ³  μμΌλ‚, RBEμ μμ ν•™μµ μ„±λ¥μ„ λ” ν° ν–‰λ ¬(μ: 1024x1024)μ— λ€ν•΄ μΈ΅μ •ν•κ³  μµμ ν™”ν•λ” μ‘μ—…μ΄ ν•„μ”ν•λ‹¤.